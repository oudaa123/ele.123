<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø¬Ù…ÙŠØ¹ Ù…Ù†ØªØ¬Ø§Øª Ø¬Ù†Ø©</title>
<style>
body {
  font-family: Tahoma, sans-serif;
  margin: 0;
  background: #f9f9f9;
}

/* Ø§Ù„Ù‡ÙŠØ¯Ø± */
header {
  background: #131921;
  color: white;
  padding: 15px;
  text-align: center;
  font-size: 20px;
  font-weight: bold;
  position: sticky;
  top: 0;
  z-index: 1000;
}
.header-buttons { margin-top: 10px; }
.header-buttons button {
  position: relative;
  background: #ffd814;
  border: 1px solid #fcd200;
  padding: 6px 12px;
  margin: 0 5px;
  border-radius: 6px;
  cursor: pointer;
  font-weight: bold;
}
.header-buttons button:hover { background: #f7ca00; }

/* Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø³Ù„Ø© */
#cart-count {
  position: absolute;
  top: -8px;
  right: -8px;
  background: red;
  color: #fff;
  font-size: 12px;
  font-weight: bold;
  padding: 2px 6px;
  border-radius: 50%;
  display: none;
}

/* Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª */
#products-container {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 12px;
  padding: 15px;
}
.product {
  border: 1px solid #ccc;
  border-radius: 10px;
  padding: 10px;
  text-align: center;
  width: 45%;
  max-width: 180px;
  background: #fff;
  box-shadow: 0 2px 5px rgba(0,0,0,0.1);
  transition: 0.3s;
}
.product:hover { box-shadow: 0 4px 12px rgba(0,0,0,0.2); }

.name { font-size: 16px; margin: 5px 0; color: #333; }
.price { font-weight: bold; margin-bottom: 5px; }
.product input {
  width: 50px;
  margin: 5px 0;
  border-radius: 5px;
  border: 1px solid #ccc;
  text-align: center;
}
.product button {
  padding: 5px 10px;
  border: none;
  border-radius: 5px;
  background: #8a2be2;
  color: #fff;
  cursor: pointer;
  font-weight: bold;
  transition: 0.3s;
}
.product button:hover { background: #6a1fbf; transform: scale(1.05); }

/* Ù†Ø§ÙØ°Ø© Ø§Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙØ§ØªÙˆØ±Ø© */
#totalModal {
  display: none;
  position: fixed;
  top: 50%; left: 50%;
  transform: translate(-50%,-50%);
  background: #fff;
  padding: 20px;
  border-radius: 15px;
  box-shadow: 0 3px 15px rgba(0,0,0,0.3);
  text-align: center;
  z-index: 1002;
  width: 90%;
  max-width: 400px;
  max-height: 80%;
  overflow-y: auto;
}
#totalModal h2 {
  font-size: 20px;
  margin-bottom: 15px;
  color: #8a2be2;
}
#totalModal button {
  margin: 5px;
  padding: 8px 15px;
  border: none;
  border-radius: 10px;
  background: #8a2be2;
  color: #fff;
  cursor: pointer;
  font-weight: bold;
  transition: 0.3s;
}
#totalModal button:hover { background: #6a1fbf; }

/* Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø³Ù„Ø© */
#cartList { text-align: right; margin-bottom: 10px; }
.cart-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  border-bottom: 1px solid #ccc;
  padding: 5px 0;
}
.cart-item span { margin: 0 5px; }
.cart-item button { padding: 2px 8px; font-size: 14px; }

#contactNumbers { margin-top: 15px; display: none; }
#contactNumbers a {
  display: block;
  color: #25d366;
  font-weight: bold;
  text-decoration: none;
  margin: 5px 0;
}
#contactNumbers a:hover { text-decoration: underline; }

#toast {
  position: fixed;
  bottom: 20px; right: 20px;
  background: #25d366;
  color: #fff;
  padding: 10px 20px;
  border-radius: 10px;
  box-shadow: 0 2px 5px rgba(0,0,0,0.3);
  display: none;
  z-index: 1003;
}

@media(max-width:600px){
  .product { width: 90%; max-width: 90%; }
  h1 { font-size: 20px; }
}
</style>
</head>
<body>

<header>
  ğŸ“¦ Ø¬Ù…ÙŠØ¹ Ù…Ù†ØªØ¬Ø§Øª Ø¬Ù†Ø©
  <div class="header-buttons">
    <button onclick="showTotal()">ğŸ›’ Ø§Ù„Ø³Ù„Ø© <span id="cart-count">0</span></button>
    <button onclick="showTotal()">ğŸ’° Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙØ§ØªÙˆØ±Ø©</button>
    <button onclick="openSupport()">â˜ï¸ Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ</button>
  </div>
</header>

<div id="products-container"></div>

<div id="totalModal">
  <h2>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙØ§ØªÙˆØ±Ø©: <span id="totalAmount">0</span> Ø¬Ù†ÙŠÙ‡</h2>
  <div id="cartList"></div>
  <button onclick="sendOrder()">ğŸ“¤ Ø¥Ø±Ø³Ø§Ù„ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨</button>
  <button onclick="closeTotalModal()">âŒ Ø¥ØºÙ„Ø§Ù‚</button>
  <div id="contactNumbers">
    <a href="https://wa.me/201067070423" target="_blank">ğŸ“ 01067070423</a>
    <a href="https://wa.me/201022495795" target="_blank">ğŸ“ 01022495795</a>
    <a href="https://wa.me/201012253500" target="_blank">ğŸ“ 01012253500</a>
  </div>
</div>

<div id="toast">ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©</div>

<script>
const SCRIPT_PRODUCTS_URL = "https://script.google.com/macros/s/AKfycbxW3_pcjSfffMTLZefZpzFIrbhijiaWY_u_4ZAmXEV2O04SMN5zplucKnAugWWbP8zzmA/exec";
const container = document.getElementById("products-container");
let productsData = [];
let cart = [];

fetch(SCRIPT_PRODUCTS_URL)
.then(res => res.json())
.then(data => {
    productsData = data;
    container.innerHTML = "";
    for(let i=0;i<productsData.length;i++){
        const item = productsData[i];
        const div = document.createElement("div");
        div.className = "product";
        div.innerHTML = `
            <div class="name">${item.name}</div>
            <div class="price">Ø§Ù„Ø³Ø¹Ø±: ${item.price} Ø¬Ù†ÙŠÙ‡</div>
            <input type="number" min="1" value="1" data-index="${i}">
            <button onclick="addToCart(${i})">Ø£Ø¶Ù Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©</button>
        `;
        container.appendChild(div);
    }
})
.catch(err=>console.log("âŒ Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª:",err));

function showToast(msg){
  const toast = document.getElementById("toast");
  toast.innerText = msg;
  toast.style.display = "block";
  setTimeout(()=>toast.style.display="none",1500);
}

// ØªØ­Ø¯ÙŠØ« Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø³Ù„Ø©
function updateCartCount(){
  const count = cart.reduce((sum, qty)=> qty ? sum+qty : sum, 0);
  const badge = document.getElementById("cart-count");
  if(count>0){
    badge.style.display = "inline-block";
    badge.innerText = count;
  } else {
    badge.style.display = "none";
  }
}

function addToCart(index){
  const input = container.querySelector(`input[data-index='${index}']`);
  const quantity = parseInt(input.value);
  if(quantity <=0) return;
  cart[index] = (cart[index] || 0) + quantity;
  updateCartCount();
  showToast(`${productsData[index].name} ØªÙ… Ø¥Ø¶Ø§ÙØªÙ‡/ØªØ­Ø¯ÙŠØ«Ù‡ ÙÙŠ Ø§Ù„Ø³Ù„Ø©`);
}

function showTotal(){
  let total = 0;
  const cartList = document.getElementById("cartList");
  cartList.innerHTML = "";
  cart.forEach((qty, idx)=>{
      if(qty){
          total += qty*productsData[idx].price;
          const itemDiv = document.createElement("div");
          itemDiv.className = "cart-item";
          itemDiv.innerHTML = `
              <span>${productsData[idx].name}</span>
              <span>Ø§Ù„Ø³Ø¹Ø±: ${productsData[idx].price} Ã— 
              <input type="number" min="1" value="${qty}" style="width:40px;" onchange="updateQty(${idx},this.value)"> = <strong>${productsData[idx].price*qty}</strong> Ø¬Ù†ÙŠÙ‡</span>
              <button onclick="removeItem(${idx})">Ø­Ø°Ù</button>
          `;
          cartList.appendChild(itemDiv);
      }
  });
  document.getElementById("totalAmount").innerText = total;
  document.getElementById("totalModal").style.display = "block";
  document.getElementById("contactNumbers").style.display = 'none';
}

function updateQty(idx, value){
  value = parseInt(value);
  if(value<=0) { delete cart[idx]; } else { cart[idx]=value; }
  updateCartCount();
  showTotal();
}
function removeItem(idx){
  delete cart[idx];
  updateCartCount();
  showTotal();
}
function closeTotalModal(){ document.getElementById("totalModal").style.display = 'none'; }

function sendOrder(){
  const contactDiv = document.getElementById("contactNumbers");
  contactDiv.style.display = 'block';
  contactDiv.querySelectorAll('a').forEach(a=>{
      a.onclick = (e)=>{
          e.preventDefault();
          let orderText = "Ø·Ù„Ø¨ÙŠØ©:%0A";
          cart.forEach((qty, idx)=>{
              if(qty){
                  orderText += `${productsData[idx].name} Ã— ${qty} = ${productsData[idx].price*qty} Ø¬Ù†ÙŠÙ‡%0A`;
              }
          });
          const total = cart.reduce((sum, qty, idx) => qty ? sum + qty*productsData[idx].price : sum, 0);
          orderText += `Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙƒÙ„ÙŠ: ${total} Ø¬Ù†ÙŠÙ‡`;
          window.open(`${a.href}?text=${orderText}`, '_blank');
      };
  });
}

function openSupport(){
  document.getElementById("totalModal").style.display = "block";
  document.getElementById("cartList").innerHTML = "<p>Ø§Ø®ØªØ± Ø±Ù‚Ù… Ù„Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ ğŸ‘‡</p>";
  document.getElementById("totalAmount").innerText = 0;
  document.getElementById("contactNumbers").style.display = 'block';
}
</script>
</body>
</html>
