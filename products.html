<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø¬Ù…ÙŠØ¹ Ù…Ù†ØªØ¬Ø§Øª Ø¬Ù†Ø©</title>
<style>
/* Ø§Ù„Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© ØªØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡ÙŠ Ù…Ø¹ Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØªØ§Ù„ÙŠ */

/* ØªØ­Ø³ÙŠÙ†Ø§Øª Ù„Ù„ÙƒÙ…ÙŠØ§Øª Ø§Ù„Ø¥Ø¬Ø¨Ø§Ø±ÙŠØ© */
.fixed-quantity {
  background: #f0f0f0;
  border: 2px solid #8a2be2;
  color: #8a2be2;
  font-weight: bold;
  cursor: not-allowed;
}

.quantity-display {
  background: #8a2be2;
  color: white;
  padding: 8px 12px;
  border-radius: 6px;
  font-weight: bold;
  font-size: 14px;
  text-align: center;
  margin: 0 auto;
  width: 80px;
}

.fixed-quantity-badge {
  position: absolute;
  top: 70px;
  left: 10px;
  background: linear-gradient(135deg, #8a2be2, #6a11cb);
  color: white;
  padding: 4px 8px;
  border-radius: 12px;
  font-size: 11px;
  font-weight: bold;
  z-index: 2;
  box-shadow: 0 2px 5px rgba(0,0,0,0.3);
  animation: pulse-badge 2s infinite;
}

.product-item.fixed-quantity-product {
  border: 2px solid #8a2be2;
}

/* ØªØ¹Ø¯ÙŠÙ„ Ù„Ø¹Ø±Ø¶ Ø§Ù„ÙƒÙ…ÙŠØ§Øª Ø­ØªÙ‰ Ù…Ø¹ Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø£Ø³Ø¹Ø§Ø± */
.hide-price .quantity-display {
  display: block !important;
}

.hide-price .fixed-quantity-badge {
  display: block !important;
}
</style>
</head>
<body class="hide-price">

<!-- Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ù€ HTML ÙŠØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡Ùˆ -->

<script>
// Ø¯Ø§Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø© Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ ÙƒÙ…ÙŠØ© Ø¥Ø¬Ø¨Ø§Ø±ÙŠØ© ÙÙŠ Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬
function hasFixedQuantity(productName) {
  return productName && /\((\d+)\)/.test(productName);
}

// Ø¯Ø§Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø© Ù„Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ø¥Ø¬Ø¨Ø§Ø±ÙŠØ© Ù…Ù† Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬
function extractFixedQuantity(productName) {
  if (!hasFixedQuantity(productName)) return 1;
  
  const match = productName.match(/\((\d+)\)/);
  return match ? parseInt(match[1]) : 1;
}

// Ø¯Ø§Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø© Ù„ØªÙ†Ø¸ÙŠÙ Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬ Ù…Ù† Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ø¥Ø¬Ø¨Ø§Ø±ÙŠØ©
function cleanProductNameWithQuantity(name) {
  if (!name) return '';
  return name.replace(/\(\d+\)/g, "").replace(/\.\./g, "").replace(/&/g, "").replace(/@/g, "").replace(/#/g, "");
}

// Ø¯Ø§Ù„Ø© Ù…Ø­Ø³Ù†Ø© Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ù…Ø¹ Ø¯Ø¹Ù… Ø§Ù„ÙƒÙ…ÙŠØ§Øª Ø§Ù„Ø¥Ø¬Ø¨Ø§Ø±ÙŠØ©
function renderProducts(data, containerElement){
  let html = "";
  
  if (data.length === 0) {
    html = `<div style="text-align: center; padding: 20px; color: #666;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª Ù„Ø¹Ø±Ø¶Ù‡Ø§</div>`;
  } else {
    data.forEach((item, index) => {
      const formattedPrice = formatPrice(item.price);
      
      // Ø§Ù„ÙƒØ´Ù Ø¹Ù† Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ ÙˆØ¬ÙˆØ¯ ".." ÙÙŠ Ø§Ù„Ø§Ø³Ù…
      const isNewProduct = item.name && item.name.includes("..");
      
      // Ø§Ù„ÙƒØ´Ù Ø¹Ù† Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø°Ø§Øª Ø§Ù„Ø¹Ø±ÙˆØ¶ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ ÙˆØ¬ÙˆØ¯ "&" ÙÙŠ Ø§Ù„Ø§Ø³Ù…
      const isOfferProduct = item.name && item.name.includes("&");
      
      // Ø§Ù„ÙƒØ´Ù Ø¹Ù† Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ØºÙŠØ± Ø§Ù„Ù…ØªÙˆÙØ±Ø© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ ÙˆØ¬ÙˆØ¯ "@" ÙÙŠ Ø§Ù„Ø§Ø³Ù…
      const isOutOfStockProduct = isOutOfStock(item.name);
      
      // Ø§Ù„ÙƒØ´Ù Ø¹Ù† Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø°Ø§Øª Ø§Ù„Ø´Ø­Ù† Ø§Ù„Ù…Ø¬Ø§Ù†ÙŠ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ ÙˆØ¬ÙˆØ¯ "#" ÙÙŠ Ø§Ù„Ø§Ø³Ù…
      const isFreeShippingProduct = hasFreeShipping(item.name);
      
      // Ø§Ù„ÙƒØ´Ù Ø¹Ù† Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø°Ø§Øª Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ø¥Ø¬Ø¨Ø§Ø±ÙŠØ©
      const isFixedQuantityProduct = hasFixedQuantity(item.name);
      const fixedQuantity = isFixedQuantityProduct ? extractFixedQuantity(item.name) : 1;
      
      // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ù†Ø¸ÙŠÙ ÙˆØ§Ù„Ù…Ù‚Ø³Ù… Ù„Ù„Ø¹Ø±Ø¶
      const displayName = cleanProductNameWithQuantity(item.name);
      
      // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø³Ø¹Ø± Ø¨Ø¹Ø¯ Ø²ÙŠØ§Ø¯Ø© 45% Ù„Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„ØªÙŠ ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ "&"
      const originalPrice = parseFloat(item.price) || 0;
      const increasedPrice = isOfferProduct ? originalPrice * 1.45 : originalPrice;
      
      html += `<div class="product-item ${isNewProduct ? 'new-product' : ''} ${isOfferProduct ? 'offer-product' : ''} ${isOutOfStockProduct ? 'out-of-stock' : ''} ${isFreeShippingProduct ? 'free-shipping-product' : ''} ${isFixedQuantityProduct ? 'fixed-quantity-product' : ''}">
                  ${isNewProduct ? '<span class="new-product-badge">ğŸ†• Ø¬Ø¯ÙŠØ¯</span>' : ''}
                  ${isOfferProduct ? '<span class="offer-product-badge">ğŸ Ø¹Ø±Ø¶ Ø®Ø§Øµ</span>' : ''}
                  ${isFreeShippingProduct ? '<span class="free-shipping-badge">ğŸšš Ø´Ø­Ù† Ù…Ø¬Ø§Ù†ÙŠ</span>' : ''}
                  ${isFixedQuantityProduct ? `<span class="fixed-quantity-badge">ğŸ“¦ ${fixedQuantity} Ù‚Ø·Ø¹</span>` : ''}
                  ${isOutOfStockProduct ? '<div class="out-of-stock-overlay"></div><div class="out-of-stock-badge">â›” ØºÙŠØ± Ù…ØªÙˆÙØ±</div>' : ''}
                  <div class="product-image-container">
                    <img src="${item.image || 'https://via.placeholder.com/200'}" 
                         onerror="handleImageError(this)" 
                         alt="${item.name}" 
                         loading="lazy">
                  </div>
                  <div class="product-info">
                    <div class="product-name">${displayName}</div>
                    ${isOfferProduct ? 
                      `<div class="product-price original-price">${formatPrice(increasedPrice)} Ø¬Ù†ÙŠÙ‡</div>
                       <div class="product-price discount-price">
                         <span class="discount-percent">Ø®ØµÙ… 45%</span>${formatPrice(originalPrice)} Ø¬Ù†ÙŠÙ‡
                       </div>` : 
                      `<div class="product-price ${isOutOfStockProduct ? 'out-of-stock-price' : ''}">${formattedPrice} Ø¬Ù†ÙŠÙ‡</div>`
                    }
                    ${!isOutOfStockProduct ? 
                      `<div class="product-controls">
                         ${isFixedQuantityProduct ? 
                           `<div class="quantity-display">${fixedQuantity} Ù‚Ø·Ø¹Ø©</div>
                            <input type="hidden" class="quantity-input fixed-quantity" value="${fixedQuantity}" data-index="${index}">` : 
                           `<input type="number" class="quantity-input" min="1" value="${cart[index] || 1}" data-index="${index}">`
                         }
                         <button class="add-to-cart-btn" onclick="addToCart(${index})">Ø£Ø¶Ù Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©</button>
                       </div>` : 
                      `<div class="product-controls">
                         <div style="height: 50px; display: flex; align-items: center; justify-content: center; color: #ff4444; font-weight: bold;">
                           â›” ØºÙŠØ± Ù…ØªÙˆÙØ± Ø­Ø§Ù„ÙŠØ§Ù‹
                         </div>
                       </div>`}
                  </div>
               </div>`;
    });
  }
  
  containerElement.innerHTML = html;
  
  // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ÙŠ Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„ÙƒÙ…ÙŠØ© (Ù„Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…ØªÙˆÙØ±Ø© ÙÙ‚Ø·)
  containerElement.querySelectorAll('.quantity-input:not(.fixed-quantity)').forEach(input => {
    input.addEventListener('change', function() {
      const index = parseInt(this.getAttribute('data-index'));
      const value = parseInt(this.value);
      updateQty(index, value);
    });
  });
  
  togglePricesVisibility();
}

// Ø¯Ø§Ù„Ø© Ù…Ø­Ø³Ù†Ø© Ù„Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø±Ù…ÙˆØ² Ù…Ù† Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬
function cleanProductName(name) {
  if (!name) return '';
  return name.replace(/\.\./g, "").replace(/&/g, "").replace(/@/g, "").replace(/#/g, "").replace(/\(\d+\)/g, "");
}

// ØªØ¹Ø¯ÙŠÙ„ Ø¯Ø§Ù„Ø© togglePricesVisibility Ù„Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ÙƒÙ…ÙŠØ§Øª Ø¯Ø§Ø¦Ù…Ø§Ù‹
function togglePricesVisibility() {
  if (pricesVisible) {
    document.body.classList.remove('hide-price');
    document.getElementById('showPricesBar').style.display = 'none';
    // Ø¥Ø¸Ù‡Ø§Ø± Ø´Ø±ÙŠØ· Ø§Ù„Ø¹Ø±ÙˆØ¶ Ø§Ù„Ù…ØªØ­Ø±Ùƒ Ø¹Ù†Ø¯ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±
    document.getElementById('movingOfferBar').style.display = 'block';
  } else {
    document.body.classList.add('hide-price');
    document.getElementById('showPricesBar').style.display = 'block';
    document.getElementById('movingOfferBar').style.display = 'none';
  }
  
  // Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„ÙƒÙ…ÙŠØ§Øª Ø§Ù„Ø¥Ø¬Ø¨Ø§Ø±ÙŠØ© ØªØ¸Ù‡Ø± Ø¯Ø§Ø¦Ù…Ø§Ù‹
  document.querySelectorAll('.quantity-display, .fixed-quantity-badge').forEach(element => {
    element.style.display = 'block';
  });
}

// ØªØ¹Ø¯ÙŠÙ„ Ø¯Ø§Ù„Ø© addToCart Ù„Ø¯Ø¹Ù… Ø§Ù„ÙƒÙ…ÙŠØ§Øª Ø§Ù„Ø¥Ø¬Ø¨Ø§Ø±ÙŠØ©
function addToCart(index){
  if (!pricesVisible) {
    showPasswordModal();
    showToast('ÙŠØ¬Ø¨ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ø£ÙˆÙ„Ø§Ù‹ Ù„Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª');
    return;
  }
  
  let quantity = 1;
  
  // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù…Ù†ØªØ¬ Ù„Ù‡ ÙƒÙ…ÙŠØ© Ø¥Ø¬Ø¨Ø§Ø±ÙŠØ©
  if (hasFixedQuantity(productsData[index].name)) {
    quantity = extractFixedQuantity(productsData[index].name);
  } else {
    const input = document.querySelector(`#products-container input[data-index='${index}']`);
    quantity = parseInt(input.value);
  }
  
  if(quantity <= 0) return;
  cart[index] = (cart[index] || 0) + quantity;
  updateCartCount();
  updateShippingBar();
  
  // ØªØ´ØºÙŠÙ„ ØµÙˆØª Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± Ø¹Ù†Ø¯ Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯
  if (productsData[index].name && productsData[index].name.includes("..")) {
    playNotificationSound();
  }
  
  // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ù†Ø¸ÙŠÙ ÙÙŠ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±
  const cleanName = cleanProductName(productsData[index].name);
  showToast(`${cleanName} ØªÙ… Ø¥Ø¶Ø§ÙØªÙ‡ Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©`);
}

// Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ© ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ ÙƒÙ…ÙŠØ§Øª Ø¥Ø¬Ø¨Ø§Ø±ÙŠØ©
const SAMPLE_PRODUCTS = [
  { name: "Ø´Ø§Ø­Ù† Ø³Ø§Ù…Ø³ÙˆÙ†Ø¬ Ø§ØµÙ„ÙŠ (3)", price: "120", image: "https://via.placeholder.com/200?text=Ø´Ø§Ø­Ù†+Ø³Ø§Ù…Ø³ÙˆÙ†Ø¬" },
  { name: "ÙƒØ§Ø¨Ù„ Ø´Ø­Ù† Ù†ÙˆØ¹ C (2)", price: "80", image: "https://via.placeholder.com/200?text=ÙƒØ§Ø¨Ù„+Ø´Ø­Ù†" },
  { name: "Ø¬Ø±Ø§Ø¨ Ø§ÙŠÙÙˆÙ† 14 (5)", price: "150", image: "https://via.placeholder.com/200?text=Ø¬Ø±Ø§Ø¨+Ø§ÙŠÙÙˆÙ†" },
  { name: "Ø³Ù…Ø§Ø¹Ø§Øª Ø§ÙŠØ±Ø¨ÙˆØ¯Ø²", price: "300", image: "https://via.placeholder.com/200?text=Ø³Ù…Ø§Ø¹Ø§Øª" },
  { name: "Ø´Ø§Ø­Ù† Ù…ØªÙ†Ù‚Ù„ 10000 (4)", price: "400", image: "https://via.placeholder.com/200?text=Ø´Ø§Ø­Ù†+Ù…ØªÙ†Ù‚Ù„" },
  { name: "Ø²Ø¬Ø§Ø¬ Ø­Ù…Ø§ÙŠØ© Ø´Ø§Ø´Ø©", price: "50", image: "https://via.placeholder.com/200?text=Ø²Ø¬Ø§Ø¬+Ø­Ù…Ø§ÙŠØ©" }
];
</script>
</body>
</html>
