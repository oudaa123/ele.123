<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>جميع منتجات جنة</title>
<style>
body { font-family: Tahoma, sans-serif; margin:0; background:#f9f9f9; }

/* الهيدر */
header {
  background: #131921;
  color:#fff;
  padding:10px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  position: sticky;
  top: 0;
  z-index: 1000;
}
header h1 { font-size:18px; margin:0; }
nav { display:flex; align-items:center; gap:10px; }
nav input {
  padding:5px;
  border:none;
  border-radius:4px;
  width:200px;
}
nav button {
  padding:5px 10px;
  border:none;
  background:#f90;
  color:#000;
  font-weight:bold;
  cursor:pointer;
  border-radius:4px;
  position: relative;
}

/* العداد فوق زر السلة */
#cart-count {
  position: absolute;
  top: -8px;
  right: -8px;
  background: red;
  color: #fff;
  font-size: 12px;
  font-weight: bold;
  padding: 2px 6px;
  border-radius: 50%;
  display: none;
}

/* المنتجات */
.products { display:grid; grid-template-columns:repeat(auto-fill,minmax(200px,1fr)); gap:10px; padding:10px; }
.product { background:#fff; border:1px solid #ddd; padding:10px; text-align:center; border-radius:6px; }
.product img { max-width:100%; height:150px; object-fit:cover; }
.product h3 { font-size:16px; margin:10px 0 5px; }
.product p { margin:5px 0; }
.product button {
  background:#28a745;
  color:#fff;
  border:none;
  padding:5px 10px;
  border-radius:4px;
  cursor:pointer;
}

/* السلة */
#cartModal {
  position:fixed;
  top:0; left:0; right:0; bottom:0;
  background:rgba(0,0,0,0.5);
  display:none;
  justify-content:center;
  align-items:center;
}
#cartContent {
  background:#fff;
  padding:20px;
  border-radius:6px;
  max-width:400px;
  width:90%;
  max-height:80%;
  overflow:auto;
}
#cart-items { margin:10px 0; }
#orderNumbers { display:none; margin-top:10px; }
#orderNumbers a { display:block; margin:5px 0; padding:8px; background:#25d366; color:#fff; text-align:center; border-radius:4px; text-decoration:none; }
</style>
</head>
<body>

<header>
  <h1>جميع منتجات جنة</h1>
  <nav>
    <input type="text" id="search" placeholder="ابحث عن منتج...">
    <button onclick="showTotal()">🛒 السلة <span id="cart-count">0</span></button>
  </nav>
</header>

<main>
  <div class="products" id="product-list"></div>
</main>

<!-- نافذة السلة -->
<div id="cartModal">
  <div id="cartContent">
    <h2>🛒 السلة</h2>
    <div id="cart-items"></div>
    <p id="cart-total"></p>
    <button onclick="sendOrder()">✅ إرسال الطلب</button>
    <button onclick="closeCart()">❌ إغلاق</button>
    <div id="orderNumbers">
      <a href="https://wa.me/201000000000">إرسال للرقم 1</a>
      <a href="https://wa.me/201111111111">إرسال للرقم 2</a>
    </div>
  </div>
</div>

<script>
const products = [
  {id:1, name:"منتج 1", price:50, img:"https://via.placeholder.com/200"},
  {id:2, name:"منتج 2", price:30, img:"https://via.placeholder.com/200"},
  {id:3, name:"منتج 3", price:70, img:"https://via.placeholder.com/200"},
  {id:4, name:"منتج 4", price:90, img:"https://via.placeholder.com/200"}
];

const productList = document.getElementById("product-list");
const cart = JSON.parse(localStorage.getItem("cart") || "{}");

function renderProducts(){
  productList.innerHTML = "";
  products.forEach(p=>{
    productList.innerHTML += `
      <div class="product">
        <img src="${p.img}" alt="${p.name}">
        <h3>${p.name}</h3>
        <p>💵 السعر: ${p.price} ج</p>
        <button onclick="addToCart(${p.id})">➕ أضف للسلة</button>
      </div>`;
  });
}
renderProducts();

function addToCart(id){
  if(!cart[id]){
    const prod = products.find(x=>x.id===id);
    cart[id] = { ...prod, qty:1 };
  } else {
    cart[id].qty++;
  }
  saveCart();
  updateCartCount();
}

function saveCart(){
  localStorage.setItem("cart", JSON.stringify(cart));
}

function updateCartCount(){
  const count = Object.values(cart).reduce((s,c)=>s+c.qty,0);
  const badge = document.getElementById("cart-count");
  if(count>0){
    badge.style.display="inline-block";
    badge.textContent = count;
  } else {
    badge.style.display="none";
  }
}
updateCartCount();

function showTotal(){
  document.getElementById("cartModal").style.display="flex";
  const itemsDiv = document.getElementById("cart-items");
  let total=0;
  let html = "<table style='width:100%; text-align:center; border-collapse:collapse;'><tr><th>الاسم</th><th>الكمية</th><th>السعر</th><th>الإجمالي</th></tr>";
  Object.values(cart).forEach(c=>{
    const lineTotal = c.qty * c.price;
    total += lineTotal;
    html += `<tr><td>${c.name}</td><td>${c.qty}</td><td>${c.price}</td><td>${lineTotal}</td></tr>`;
  });
  html += "</table>";
  itemsDiv.innerHTML = html;
  document.getElementById("cart-total").textContent = "✅ المجموع الكلي: " + total + " ج";
}

function closeCart(){
  document.getElementById("cartModal").style.display="none";
}

function sendOrder(){
  const orderDiv = document.getElementById("orderNumbers");
  orderDiv.style.display = "block";
  orderDiv.querySelectorAll("a").forEach(a=>{
    a.onclick = (e)=>{
      e.preventDefault();
      let total = 0;
      let text = "🧾 *طلبية جديدة* %0A%0A";
      text += `الاسم | الكمية | السعر | الإجمالي%0A`;
      text += `-----------------------%0A`;

      Object.values(cart).forEach(c=>{
        const lineTotal = c.qty * c.price;
        total += lineTotal;
        text += `${c.name} | ${c.qty} | ${c.price}ج | ${lineTotal}ج%0A`;
      });

      text += `-----------------------%0A`;
      text += `✅ *المجموع الكلي:* ${total} جنيه`;

      window.open(`${a.href}?text=${text}`,"_blank");
    };
  });
}
</script>

</body>
</html>
