<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>عروض حصرية - جنة لجميع أكسسوارات المحمول</title>
<style>
:root {
  --primary-color: #8a2be2;
  --secondary-color: #ffd814;
  --accent-color: #ff4444;
  --text-color: #333;
  --light-bg: #f9f9f9;
  --card-bg: #fff;
}

* {
  box-sizing: border-box;
}

body { 
  font-family: Tahoma, sans-serif; 
  margin: 0; 
  background: var(--light-bg);
  font-size: 14px;
  padding-bottom: 60px;
  max-width: 100%;
  overflow-x: hidden;
  height: 100%;
}

/* تحسين الهيدر ليكون أكثر جاذبية */
header {
  background: linear-gradient(135deg, #131921, #8a2be2);
  color: white;
  padding: 15px 5px;
  text-align: center;
  font-size: 20px;
  font-weight: bold;
  position: sticky;
  top: 0;
  z-index: 1000;
  width: 100%;
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
}

.header-buttons {
   margin-top: 12px;
   display: flex;
   flex-wrap: wrap;
   justify-content: center;
   gap: 8px;
   position: relative;
}
.header-buttons button {
  background: var(--secondary-color);
  border: 1px solid #fcd200;
  padding: 8px 16px;
  border-radius: 30px;
  cursor: pointer;
  font-weight: bold;
  font-size: 14px;
  white-space: nowrap;
  position: relative;
  transition: all 0.3s;
  box-shadow: 0 2px 5px rgba(0,0,0,0.1);
}
.header-buttons button:hover { 
  background: #f7ca00; 
  transform: translateY(-2px);
  box-shadow: 0 4px 8px rgba(0,0,0,0.2);
}

/* تحسينات للعروض */
.promo-banner {
  background: linear-gradient(135deg, #ff6600, #ff3300);
  color: white;
  text-align: center;
  padding: 12px;
  margin: 10px 0;
  border-radius: 10px;
  font-weight: bold;
  animation: promoPulse 2s infinite;
  cursor: pointer;
  box-shadow: 0 4px 10px rgba(255, 102, 0, 0.3);
}

@keyframes promoPulse {
  0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(255, 102, 0, 0.7); }
  50% { transform: scale(1.02); box-shadow: 0 0 0 10px rgba(255, 102, 0, 0); }
  100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(255, 102, 0, 0); }
}

/* تحسينات للمنتجات */
#products-container {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
  gap: 15px;
  padding: 15px;
  width: 100%;
}
.product {
  background: var(--card-bg);
  border-radius: 12px;
  overflow: hidden;
  box-shadow: 0 4px 8px rgba(0,0,0,0.1);
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  transition: 0.3s;
  position: relative;
  width: 100%;
}
.product:hover { 
  box-shadow: 0 6px 15px rgba(0,0,0,0.2); 
  transform: translateY(-5px);
}
.product img { 
  width: 100%; 
  height: 140px; 
  object-fit: contain; 
  background: #f9f9f9; 
  padding: 8px;
}
.product-info { padding: 10px; text-align: center; }
.product-info .name { 
  font-size: 14px; 
  margin-bottom: 6px; 
  color: var(--text-color); 
  font-weight: bold;
  height: 40px;
  overflow: hidden;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
}
.product-info .price { 
  font-size: 16px; 
  color: var(--primary-color); 
  margin-bottom: 8px; 
  font-weight: bold;
}
.product input { 
  width: 50px; 
  margin: 6px auto; 
  border-radius: 6px; 
  border: 1px solid #ccc; 
  text-align: center;
  font-size: 14px;
  padding: 6px;
}
.product button { 
  padding: 8px 12px; 
  border: none; 
  border-radius: 6px; 
  background: var(--primary-color); 
  color: #fff; 
  cursor: pointer; 
  font-weight: bold; 
  font-size: 14px;
  transition: 0.3s; 
  margin-top: 8px;
  box-shadow: 0 2px 5px rgba(0,0,0,0.1);
}
.product button:hover { 
  background: #6a1fbf; 
  transform: scale(1.05);
  box-shadow: 0 4px 8px rgba(0,0,0,0.2);
}

/* تحسينات للعروض الخاصة */
.promo-badge {
  position: absolute;
  top: 8px;
  right: 8px;
  background: linear-gradient(135deg, #ff4444, #cc0000);
  color: white;
  padding: 6px 10px;
  border-radius: 20px;
  font-size: 12px;
  font-weight: bold;
  z-index: 1;
  box-shadow: 0 2px 5px rgba(0,0,0,0.3);
  animation: pulse-badge 2s infinite;
  display: flex;
  align-items: center;
  gap: 3px;
}

.hot-badge {
  position: absolute;
  top: 8px;
  left: 8px;
  background: linear-gradient(135deg, #ff6600, #ff3300);
  color: white;
  padding: 6px 10px;
  border-radius: 20px;
  font-size: 12px;
  font-weight: bold;
  z-index: 1;
  box-shadow: 0 2px 5px rgba(0,0,0,0.3);
  animation: pulse-badge 2s infinite;
  display: flex;
  align-items: center;
  gap: 3px;
}

/* تحسينات إضافية */
.quick-actions {
  display: flex;
  justify-content: center;
  gap: 5px;
  margin-top: 8px;
}

.quick-add-btn {
  background: #25d366 !important;
  padding: 6px 10px !important;
  font-size: 12px !important;
}

.quick-add-btn:hover {
  background: #1da851 !important;
}

/* تحسينات للاستجابة على جميع الشاشات */
@media (min-width: 1200px) {
  #products-container {
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    max-width: 1200px;
    margin: 0 auto;
  }
}

@media (max-width: 768px) {
  #products-container {
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
  }
}

@media (max-width: 480px){
  #products-container { 
    grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); 
    gap: 10px;
    padding: 10px;
  }
}

/* باقي الأنماط تبقى كما هي مع تعديلات طفيفة */
/* ... */
</style>
</head>
<body class="hide-price">

<div id="showPricesBar" onclick="showPasswordModal()">
  👁️ اعرض الأسرار والعروض
</div>

<button id="saveCartBtn" onclick="saveCart()">💾 حفظ الطلب</button>

<header>
  🎁 عروض حصرية - جنة لجميع أكسسوارات المحمول
  <div class="header-buttons">
    <button id="cartBtn">🛒 سلة المشتريات <span id="cart-count">0</span></button>
    <button id="totalBtn">💰 طلبي</button>
    <button id="supportBtn">☎️ الدعم والاستفسار</button>
    <button onclick="showPromoGuide()">📖 كيف أطلب؟</button>
    <button id="notifBtn">🔔 عروض جديدة <span id="notif-count">0</span></button>
    <button id="clearCartBtn" onclick="clearCart()">🗑️ مسح الكل</button>
  </div>

  <div class="search-container">
    <input type="text" id="searchBox" placeholder="🔍 ابحث عن منتج...">
    <button id="offerBtn">💥 عروض خاصة</button>
  </div>
</header>

<!-- إعلان البرومو -->
<div class="promo-banner" onclick="showPromoMessage()">
  🎉 عروض خاصة لفترة محدودة - أسعار لا تُعوض! 🎉
</div>

<!-- دليل البرومو -->
<div id="promoGuide" style="display: none; background: white; padding: 15px; margin: 10px; border-radius: 10px; box-shadow: 0 4px 10px rgba(0,0,0,0.1);">
  <h3 style="text-align: center; color: var(--primary-color);">📖 دليل الطلب السريع</h3>
  <ol style="padding-right: 20px;">
    <li>تصفح المنتجات واضغط على "أضف إلى السلة"</li>
    <li>اضغط على "🛒 سلة المشتريات" لمراجعة طلبك</li>
    <li>اضغط على "📤 ارسل طلبك" لإنهاء الطلب</li>
    <li>اختر رقم الواتساب لإرسال الطلب</li>
    <li>سيتم التواصل معك لتأكيد الطلب والتوصيل</li>
  </ol>
  <button onclick="closePromoGuide()" style="background: var(--primary-color); color: white; border: none; padding: 8px 15px; border-radius: 6px; cursor: pointer; display: block; margin: 10px auto;">حسنًا، فهمت</button>
</div>

<!-- باقي الكود يبقى كما هو مع تعديلات طفيفة -->
<!-- ... -->

<script>
// إضافة وظائف جديدة للبرومو
function showPromoGuide() {
  document.getElementById('promoGuide').style.display = 'block';
}

function closePromoGuide() {
  document.getElementById('promoGuide').style.display = 'none';
}

function showPromoMessage() {
  showToast('🎁 استمتع بأفضل العروض والأسعار! تواصل معنا لمعرفة التفاصيل.');
}

// تعديل دالة عرض المنتجات لتكون أكثر جاذبية
function renderProducts(data, containerElement){
  let html = "";
  
  if (data.length === 0) {
    html = `<div style="text-align: center; padding: 20px; color: #666;">لا توجد منتجات لعرضها حالياً</div>`;
  } else {
    data.forEach((item, index) => {
      const formattedPrice = formatPrice(item.price);
      
      // الكشف عن المنتجات الجديدة بناءً على وجود ".." في الاسم
      const isNewProduct = item.name && item.name.includes("..");
      
      // الكشف عن المنتجات ذات العروض بناءً على وجود "&" في الاسم
      const isOfferProduct = item.name && item.name.includes("&");
      
      // الكشف عن المنتجات المنتهية بناءً على وجود "@" في الاسم
      const isOutOfStock = item.name && item.name.includes("@");
      
      // الكشف عن المنتجات الساخنة بناءً على وجود "#" في الاسم
      const isHotProduct = item.name && item.name.includes("#");
      
      // إزالة الرموز من الاسم للعرض
      const displayName = cleanProductName(item.name);
      
      // حساب السعر بعد زيادة 45% للمنتجات التي تحتوي على "&"
      const originalPrice = parseFloat(item.price) || 0;
      const increasedPrice = isOfferProduct ? originalPrice * 1.45 : originalPrice;
      
      html += `<div class="product ${isNewProduct ? 'new-product' : ''} ${isOfferProduct ? 'offer-product' : ''} ${isOutOfStock ? 'out-of-stock-product' : ''} ${isHotProduct ? 'hot-product' : ''}">
                  ${isNewProduct ? '<span class="promo-badge">🆕 جديد</span>' : ''}
                  ${isOfferProduct ? '<span class="promo-badge">🎁 عرض خاص</span>' : ''}
                  ${isHotProduct ? '<span class="hot-badge">🔥 الأكثر طلباً</span>' : ''}
                  ${isOutOfStock ? '<span class="out-of-stock-badge">⛔ منتهي</span>' : ''}
                  <div class="product-image-container">
                    <img src="${item.image || 'https://via.placeholder.com/150'}" 
                         onerror="handleImageError(this)" 
                         alt="${displayName}" 
                         loading="lazy">
                  </div>
                  <div class="product-info">
                    <div class="name">${displayName}</div>
                    ${isOfferProduct ? 
                      `<div class="price original-price">${formatPrice(increasedPrice)} جنيه</div>
                       <div class="price discount-price">
                         <span class="discount-percent">خصم 45%</span>${formatPrice(originalPrice)} جنيه
                       </div>` : 
                      `<div class="price">${formattedPrice} جنيه</div>`
                    }
                    ${!isOutOfStock ? `
                    <input type="number" min="1" value="${cart[index] || 1}" data-index="${index}">
                    <div class="quick-actions">
                      <button onclick="addToCart(${index})">أضف إلى السلة</button>
                      <button class="quick-add-btn" onclick="quickAdd(${index})">+</button>
                    </div>
                    ` : ''}
                    <div class="free-shipping-text">🚚 توصيل مجاني</div>
                  </div>
               </div>`;
    });
  }
  
  containerElement.innerHTML = html;
  
  // إضافة مستمعي الأحداث لحقول الكمية (للمنتجات المتاحة فقط)
  containerElement.querySelectorAll('input[type="number"]').forEach(input => {
    input.addEventListener('change', function() {
      const index = parseInt(this.getAttribute('data-index'));
      const value = parseInt(this.value);
      updateQty(index, value);
    });
  });
  
  togglePricesVisibility();
}

// دالة الإضافة السريعة
function quickAdd(index) {
  if (!pricesVisible) {
    showPasswordModal();
    showToast('يجب إدخال كلمة السر أولاً لإضافة المنتجات');
    return;
  }
  
  // التحقق مما إذا كان المنتج منتهيًا
  if (productsData[index].name && productsData[index].name.includes("@")) {
    showToast('هذا المنتج منتهي ولا يمكن إضافته إلى السلة');
    return;
  }
  
  cart[index] = (cart[index] || 0) + 1;
  updateCartCount();
  
  // استخدام الاسم النظيف في الإشعار
  const cleanName = cleanProductName(productsData[index].name);
  showToast(`تم إضافة ${cleanName} إلى السلة`);
}

// تحسين تنسيق فاتورة الواتساب لتكون أكثر وضوحاً
function formatWhatsAppInvoice() {
  const now = new Date();
  const dateOptions = { 
    weekday: 'long', 
    year: 'numeric', 
    month: 'long', 
    day: 'numeric' 
  };
  const timeOptions = {
    hour: '2-digit',
    minute: '2-digit'
  };
  
  const dateStr = now.toLocaleDateString('ar-EG', dateOptions);
  const timeStr = now.toLocaleTimeString('ar-EG', timeOptions);
  
  let text = `🛒 طلب جديد - جنة لأكسسوارات المحمول\n`;
  text += `══════════════════\n`;
  text += `📅 التاريخ: ${dateStr}\n`;
  text += `⏰ الوقت: ${timeStr}\n`;
  text += `🚚 التوصيل مجاني\n`;
  text += `══════════════════\n\n`;
  text += `📋 تفاصيل الطلب:\n`;
  text += `══════════════════\n`;
  
  let total = 0;
  cart.forEach((qty, idx) => {
    if(qty && productsData[idx]){
      const price = parseFloat(productsData[idx].price) || 0;
      const lineTotal = qty * price;
      total += lineTotal;
      
      // استخدام الاسم النظيف بدون رموز
      const cleanName = cleanProductName(productsData[idx].name);
      
      text += `📦 ${cleanName}\n`;
      text += `   الكمية: ${qty}\n`;
      text += `   السعر: ${formatPrice(price)} جنيه\n`;
      text += `   الإجمالي: ${formatPrice(lineTotal)} جنيه\n`;
      text += `──────────────────\n`;
    }
  });
  
  text += `\n💰 الإجمالي الكلي: ${formatPrice(total)} جنيه\n\n`;
  text += `شكراً لاختياركم جنة 🌹\n`;
  text += `سيتم التواصل معكم خلال 12 ساعة لتأكيد الطلب`;
  
  return text;
}

// تعديل نص الأزرار لتكون أكثر وضوحاً للعملاء
document.getElementById("sendBtn").innerText = "📤 ارسل طلبك الآن";

// باقي الكود يبقى كما هو مع تعديلات طفيفة
// ...
</script>
</body>
</html>
